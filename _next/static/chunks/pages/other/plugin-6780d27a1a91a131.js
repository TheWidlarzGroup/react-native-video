(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376],{9e3:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/other/plugin",function(){return n(1214)}])},1214:function(e,s,n){"use strict";n.r(s),n.d(s,{__toc:function(){return o}});var l=n(5893),r=n(2673),i=n(2643);let o=[{depth:2,value:"Commercial Plugins",id:"commercial-plugins"},{depth:2,value:"Plugins for Analytics",id:"plugins-for-analytics"},{depth:2,value:"Warnings & Considerations",id:"warnings--considerations"},{depth:2,value:"General Setup",id:"general-setup"},{depth:2,value:"Plugin Types",id:"plugin-types"},{depth:2,value:"Android Implementation",id:"android-implementation"},{depth:3,value:"1. Create the Plugin",id:"1-create-the-plugin"},{depth:4,value:"Base Plugin",id:"base-plugin"},{depth:4,value:"ExoPlayer-Specific Plugin",id:"exoplayer-specific-plugin"},{depth:3,value:"2. Register the Plugin",id:"2-register-the-plugin"},{depth:3,value:"Extending Core Functionality via Plugins",id:"extending-core-functionality-via-plugins"},{depth:4,value:"Plugin Extension Points (Android)",id:"plugin-extension-points-android"},{depth:5,value:"1. overrideMediaItemBuilder",id:"1-overridemediaitembuilder"},{depth:5,value:"2. overrideMediaDataSourceFactory",id:"2-overridemediadatasourcefactory"},{depth:5,value:"3. shouldDisableCache",id:"3-shoulddisablecache"},{depth:2,value:"iOS Implementation",id:"ios-implementation"},{depth:3,value:"1. Podspec Integration",id:"1-podspec-integration"},{depth:3,value:"2. Create the Plugin",id:"2-create-the-plugin"},{depth:4,value:"Base Plugin",id:"base-plugin-1"},{depth:4,value:"AVPlayer-Specific Plugin",id:"avplayer-specific-plugin"},{depth:5,value:"OverridePlayerAssetResult and OverridePlayerAssetType",id:"overrideplayerassetresult-and-overrideplayerassettype"},{depth:3,value:"3. Register the Plugin",id:"3-register-the-plugin"},{depth:2,value:"Custom DRM Manager",id:"custom-drm-manager"},{depth:3,value:"Android Implementation",id:"android-implementation-1"},{depth:4,value:"1/ Create custom DRM manager",id:"1-create-custom-drm-manager"},{depth:4,value:"2/ Register DRM manager in your plugin",id:"2-register-drm-manager-in-your-plugin"},{depth:3,value:"iOS Implementation",id:"ios-implementation-1"},{depth:4,value:"1/ Create custom DRM manager",id:"1-create-custom-drm-manager-1"},{depth:4,value:"2/ Register DRM manager in your plugin",id:"2-register-drm-manager-in-your-plugin-1"},{depth:3,value:"Important notes about DRM managers:",id:"important-notes-about-drm-managers"}];function a(e){let s=Object.assign({h1:"h1",p:"p",code:"code",a:"a",h2:"h2",blockquote:"blockquote",strong:"strong",pre:"pre",span:"span",ol:"ol",li:"li",ul:"ul",h3:"h3",h4:"h4",hr:"hr",h5:"h5"},(0,i.a)(),e.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h1,{children:"Plugin"}),"\n",(0,l.jsxs)(s.p,{children:["Since version ",(0,l.jsx)(s.code,{children:"6.4.0"}),", it is possible to create plugins for analytics management and potentially more.\nA sample plugin is available in the repository: ",(0,l.jsx)(s.a,{href:"https://github.com/TheWidlarzGroup/react-native-video/tree/master/examples/react-native-video-plugin-sample",children:"example/react-native-video-plugin-sample"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"commercial-plugins",children:"Commercial Plugins"}),"\n",(0,l.jsxs)(s.p,{children:["We at The Widlarz Group have created a set of plugins for comprehensive offline video support. If you are interested, check out our ",(0,l.jsx)(s.a,{href:"https://www.thewidlarzgroup.com/offline-video-sdk/?utm_source=rnv&utm_medium=docs&utm_campaign=plugins&utm_id=text",children:"Offline Video SDK"}),". If you need additional plugins (analytics, processing, etc.), let us know."]}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsx)(s.p,{children:"Using or recommending our commercial software helps support the maintenance of this open-source project. Thank you!"}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"plugins-for-analytics",children:"Plugins for Analytics"}),"\n",(0,l.jsxs)(s.p,{children:["Most analytics systems that track player data (e.g., bitrate, errors) can be integrated directly with ExoPlayer or AVPlayer.\nThis plugin system allows for non-intrusive analytics integration with ",(0,l.jsx)(s.code,{children:"react-native-video"}),". It should be implemented in native languages (Kotlin/Swift) to ensure efficiency."]}),"\n",(0,l.jsxs)(s.p,{children:["The goal is to enable easy analytics integration without modifying ",(0,l.jsx)(s.code,{children:"react-native-video"})," itself."]}),"\n",(0,l.jsx)(s.h2,{id:"warnings--considerations",children:"Warnings & Considerations"}),"\n",(0,l.jsxs)(s.p,{children:["This is an ",(0,l.jsx)(s.strong,{children:"experimental API"})," and may change over time. The API is simple yet flexible enough to implement analytics systems.\nIf additional metadata is needed, you should implement a setter in your custom package."]}),"\n",(0,l.jsxs)(s.p,{children:["Since the API is flexible, misuse is possible. The player handle should be treated as ",(0,l.jsx)(s.strong,{children:"read-only"}),". Modifying player behavior may cause unexpected issues in ",(0,l.jsx)(s.code,{children:"react-native-video"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"general-setup",children:"General Setup"}),"\n",(0,l.jsx)(s.p,{children:"First, create a new React Native package:"}),"\n",(0,l.jsx)(s.pre,{"data-language":"shell","data-theme":"default",children:(0,l.jsx)(s.code,{"data-language":"shell","data-theme":"default",children:(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"npx"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"create-react-native-library@latest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"react-native-video-custom-analytics"})]})})}),"\n",(0,l.jsxs)(s.p,{children:["Both Android and iOS implementations expose an ",(0,l.jsx)(s.code,{children:"RNVPlugin"})," interface.\nYour ",(0,l.jsx)(s.code,{children:"react-native-video-custom-analytics"})," package should implement this interface and register itself as a plugin for ",(0,l.jsx)(s.code,{children:"react-native-video"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"plugin-types",children:"Plugin Types"}),"\n",(0,l.jsx)(s.p,{children:"There are two types of plugins you can implement:"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsxs)(s.strong,{children:["Base Plugin (",(0,l.jsx)(s.code,{children:"RNVPlugin"}),")"]}),": For general-purpose plugins that don't need specific player implementation details."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Player-Specific Plugins"}),":\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"RNVAVPlayerPlugin"})," for iOS: Provides type-safe access to AVPlayer instances"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"RNVExoplayerPlugin"})," for Android: Provides type-safe access to ExoPlayer instances"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"Choose the appropriate plugin type based on your needs. If you need direct access to player-specific APIs, use the player-specific plugin classes."}),"\n",(0,l.jsx)(s.h2,{id:"android-implementation",children:"Android Implementation"}),"\n",(0,l.jsx)(s.h3,{id:"1-create-the-plugin",children:"1. Create the Plugin"}),"\n",(0,l.jsxs)(s.p,{children:["You can implement either the base ",(0,l.jsx)(s.code,{children:"RNVPlugin"})," interface or the player-specific ",(0,l.jsx)(s.code,{children:"RNVExoplayerPlugin"})," interface."]}),"\n",(0,l.jsx)(s.h4,{id:"base-plugin",children:"Base Plugin"}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"MyAnalyticsPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" : "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"RNVPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Any"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player creation"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Any"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player removal"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.h4,{id:"exoplayer-specific-plugin",children:"ExoPlayer-Specific Plugin"}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"MyExoPlayerAnalyticsPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" : "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"RNVExoplayerPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ExoPlayer"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle ExoPlayer creation with type-safe access"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ExoPlayer"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle ExoPlayer removal with type-safe access"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"RNVPlugin"})," interface defines two functions:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Function called when a new player is created"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" id: a random string identifying the player"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" player: the instantiated player reference"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" */"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Any"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Function called when a player should be destroyed"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * when this callback is called, the plugin shall free all"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * resources and release all reference to Player object"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" id: a random string identifying the player"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" player: the player to release"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" */"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Any"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsx)(s.h3,{id:"2-register-the-plugin",children:"2. Register the Plugin"}),"\n",(0,l.jsxs)(s.p,{children:["To register the plugin within the main ",(0,l.jsx)(s.code,{children:"react-native-video"})," package, call:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsx)(s.code,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ReactNativeVideoManager."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getInstance"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"()."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"registerPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(plugin)"})]})})}),"\n",(0,l.jsxs)(s.p,{children:["In the sample implementation, the plugin is registered in the ",(0,l.jsx)(s.code,{children:"createNativeModules"})," entry point."]}),"\n",(0,l.jsx)(s.p,{children:"Once registered, your module can track player updates and report analytics data."}),"\n",(0,l.jsx)(s.h3,{id:"extending-core-functionality-via-plugins",children:"Extending Core Functionality via Plugins"}),"\n",(0,l.jsxs)(s.p,{children:["In addition to analytics, plugins can also be used to modify or override core behavior of ",(0,l.jsx)(s.code,{children:"react-native-video"}),"."]}),"\n",(0,l.jsx)(s.p,{children:"This allows native modules to deeply integrate with the playback system - for example:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"replacing the media source factory,"}),"\n",(0,l.jsx)(s.li,{children:"modifying the media item before playback starts (e.g., injecting stream keys),"}),"\n",(0,l.jsx)(s.li,{children:"disabling caching dynamically per source."}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:["These capabilities are available through the advanced Android plugin interface: ",(0,l.jsx)(s.code,{children:"RNVExoplayerPlugin"}),"."]}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsx)(s.p,{children:"⚠️ These extension points are optional — if no plugin provides them, the player behaves exactly as it did before."}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h4,{id:"plugin-extension-points-android",children:"Plugin Extension Points (Android)"}),"\n",(0,l.jsxs)(s.p,{children:["If your plugin implements ",(0,l.jsx)(s.code,{children:"RNVExoplayerPlugin"}),", you can override the following methods:"]}),"\n",(0,l.jsxs)(s.h5,{id:"1-overridemediaitembuilder",children:["1. ",(0,l.jsx)(s.code,{children:"overrideMediaItemBuilder"})]}),"\n",(0,l.jsxs)(s.p,{children:["Allows you to modify the ",(0,l.jsx)(s.code,{children:"MediaItem.Builder"})," before it’s used. You can inject stream keys, cache keys, or override URIs."]}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"overrideMediaItemBuilder"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    source: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Source"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    mediaItemBuilder: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"MediaItem"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".Builder"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"): "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"MediaItem"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".Builder? {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Return modified builder or null to use default"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(s.h5,{id:"2-overridemediadatasourcefactory",children:["2. ",(0,l.jsx)(s.code,{children:"overrideMediaDataSourceFactory"})]}),"\n",(0,l.jsx)(s.p,{children:"Lets you replace the data source used by ExoPlayer. Useful for implementing read-only cache or request interception."}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"overrideMediaDataSourceFactory"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    source: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Source"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    mediaDataSourceFactory: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DataSource"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".Factory"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"): "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DataSource"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:".Factory? {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Return your custom factory or null to use default"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(s.h5,{id:"3-shoulddisablecache",children:["3. ",(0,l.jsx)(s.code,{children:"shouldDisableCache"})]}),"\n",(0,l.jsx)(s.p,{children:"Enables dynamic disabling of the caching system per source."}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"shouldDisableCache"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(source: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Source"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"): "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Boolean"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// your own logic"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsxs)(s.p,{children:["Once implemented, ",(0,l.jsx)(s.code,{children:"react-native-video"})," will automatically invoke these methods for each ",(0,l.jsx)(s.code,{children:"<Video />"})," instance."]}),"\n",(0,l.jsx)(s.h2,{id:"ios-implementation",children:"iOS Implementation"}),"\n",(0,l.jsx)(s.h3,{id:"1-podspec-integration",children:"1. Podspec Integration"}),"\n",(0,l.jsxs)(s.p,{children:["Your new module must have access to ",(0,l.jsx)(s.code,{children:"react-native-video"}),". Add it as a dependency in your Podspec file:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"podfile","data-theme":"default",children:(0,l.jsx)(s.code,{"data-language":"podfile","data-theme":"default",children:(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'s.dependency "react-native-video"'})})})}),"\n",(0,l.jsx)(s.h3,{id:"2-create-the-plugin",children:"2. Create the Plugin"}),"\n",(0,l.jsxs)(s.p,{children:["You can implement either the base ",(0,l.jsx)(s.code,{children:"RNVPlugin"})," class or the player-specific ",(0,l.jsx)(s.code,{children:"RNVAVPlayerPlugin"})," class."]}),"\n",(0,l.jsx)(s.h4,{id:"base-plugin-1",children:"Base Plugin"}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"MyAnalyticsPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"RNVPlugin "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Any"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player creation"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Any"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player removal"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.h4,{id:"avplayer-specific-plugin",children:"AVPlayer-Specific Plugin"}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"MyAVPlayerAnalyticsPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"RNVAVPlayerPlugin "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVPlayer) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle AVPlayer creation with type-safe access"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVPlayer) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle AVPlayer removal with type-safe access"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/// Optionally override the asset used by the player before playback starts"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"overridePlayerAsset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"source"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": VideoSource, "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"asset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVAsset) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OverridePlayerAssetResult"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Return a modified asset or nil to use the default"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"RNVAVPlayerPlugin"})," class defines several extension points:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Function called when a new AVPlayer instance is created"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @param id: a random string identifying the player"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @param player: the instantiated AVPlayer"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" */"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"open"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVPlayer) { "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/* no-op */"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" }"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Function called when an AVPlayer instance is being removed"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @param id: a random string identifying the player"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @param player: the AVPlayer to release"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" */"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"open"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVPlayer) { "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/* no-op */"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" }"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Optionally override the asset used by the player before playback starts."})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Allows you to modify or replace the AVAsset before it is used to create the AVPlayerItem."})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * Return nil to use the default asset."})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" *"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @param source: The VideoSource describing the video (uri, type, headers, etc.)"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @param asset: The AVAsset prepared by the player"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" * @return: OverridePlayerAssetResult if you want to override, or nil to use the default"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" */"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"open"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"overridePlayerAsset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"source"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": VideoSource, "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"asset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVAsset) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OverridePlayerAssetResult"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"nil"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" }"})]})]})}),"\n",(0,l.jsxs)(s.h5,{id:"overrideplayerassetresult-and-overrideplayerassettype",children:[(0,l.jsx)(s.code,{children:"OverridePlayerAssetResult"})," and ",(0,l.jsx)(s.code,{children:"OverridePlayerAssetType"})]}),"\n",(0,l.jsxs)(s.p,{children:["To override the asset, return an ",(0,l.jsx)(s.code,{children:"OverridePlayerAssetResult"}),":"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"OverridePlayerAssetResult"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" type: OverridePlayerAssetType"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" asset: AVAsset"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"init"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"type"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": OverridePlayerAssetType, "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"asset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVAsset) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    self.type "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" type"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    self.asset "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" asset"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"enum"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"OverridePlayerAssetType"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" partial "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Return a partially modified asset; will go through the default prepare process"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"case"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" full    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Return a fully modified asset; will skip the default prepare process"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Use ",(0,l.jsx)(s.code,{children:".partial"})," if you want the asset to continue through the player's normal preparation (e.g., for text tracks or metadata injection)."]}),"\n",(0,l.jsxs)(s.li,{children:["Use ",(0,l.jsx)(s.code,{children:".full"})," if you want to provide a fully prepared asset that will be used as-is for playback."]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example:"})}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"overridePlayerAsset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"source"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": VideoSource, "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"asset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVAsset) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" OverridePlayerAssetResult"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Example: Replace the asset URL"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" newAsset "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"AVAsset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"url"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" URL"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"string"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://example.com/override.mp4"'}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Result"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"type"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" .full, asset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" newAsset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsx)(s.p,{children:"Only one plugin can override the player asset at a time. If multiple plugins implement this, only the first will be used."}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"3-register-the-plugin",children:"3. Register the Plugin"}),"\n",(0,l.jsxs)(s.p,{children:["To register the plugin in ",(0,l.jsx)(s.code,{children:"react-native-video"}),", call:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsx)(s.code,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ReactNativeVideoManager.shared."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"registerPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"plugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" plugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]})})}),"\n",(0,l.jsxs)(s.p,{children:["In the sample implementation, the plugin is registered inside the ",(0,l.jsx)(s.code,{children:"VideoPluginSample"})," file within the ",(0,l.jsx)(s.code,{children:"init"})," function:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"react_native_video"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."})}),"\n",(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"init"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    super."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"init"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ReactNativeVideoManager.shared."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"registerPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"plugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" self"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.p,{children:"Once registered, your module can track player updates and report analytics data to your backend."}),"\n",(0,l.jsx)(s.h2,{id:"custom-drm-manager",children:"Custom DRM Manager"}),"\n",(0,l.jsx)(s.p,{children:"You can provide a custom DRM manager through your plugin to handle DRM in a custom way. This is useful when you need to integrate with a specific DRM provider or implement custom DRM logic."}),"\n",(0,l.jsx)(s.h3,{id:"android-implementation-1",children:"Android Implementation"}),"\n",(0,l.jsx)(s.h4,{id:"1-create-custom-drm-manager",children:"1/ Create custom DRM manager"}),"\n",(0,l.jsxs)(s.p,{children:["Create a class that implements the ",(0,l.jsx)(s.code,{children:"DRMManagerSpec"})," interface:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CustomDRMManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" : "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DRMManagerSpec"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"@Throws"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(UnsupportedDrmException::"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"buildDrmSessionManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(uuid: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UUID"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", drmProps: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DRMProps"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"): "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DrmSessionManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Your custom implementation for building DRM session manager"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Return null if the DRM scheme is not supported"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Throw UnsupportedDrmException if the DRM scheme is invalid"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.h4,{id:"2-register-drm-manager-in-your-plugin",children:"2/ Register DRM manager in your plugin"}),"\n",(0,l.jsxs)(s.p,{children:["Implement ",(0,l.jsx)(s.code,{children:"getDRMManager()"})," in your ExoPlayer plugin to provide the custom DRM manager:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CustomVideoPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" : "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"RNVExoplayerPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"private"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"val"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" drmManager "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CustomDRMManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getDRMManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(): "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DRMManagerSpec"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" drmManager"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ExoPlayer"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player creation"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(id: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", player: "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ExoPlayer"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player removal"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.h3,{id:"ios-implementation-1",children:"iOS Implementation"}),"\n",(0,l.jsx)(s.h4,{id:"1-create-custom-drm-manager-1",children:"1/ Create custom DRM manager"}),"\n",(0,l.jsxs)(s.p,{children:["Create a class that implements the ",(0,l.jsx)(s.code,{children:"DRMManagerSpec"})," protocol:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CustomDRMManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"NSObject"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"DRMManagerSpec "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createContentKeyRequest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"asset"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVContentKeyRecipient,"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"drmProps"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": DRMParams"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"reactTag"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": NSNumber"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onVideoError"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": RCTDirectEventBlock"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onGetLicense"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": RCTDirectEventBlock"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ) {"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Initialize content key session and handle key request"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"handleContentKeyRequest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"keyRequest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVContentKeyRequest) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Process the content key request"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"finishProcessingContentKeyRequest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"keyRequest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVContentKeyRequest, "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"license"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": Data) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throws"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Finish processing the key request with the obtained license"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"handleError"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"_"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"error"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Error"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"for"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-parameter)"},children:"keyRequest"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVContentKeyRequest) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle any errors during the DRM process"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"setJSLicenseResult"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"license"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"licenseUrl"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle successful license acquisition from JS side"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"setJSLicenseError"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"error"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"licenseUrl"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle license acquisition errors from JS side"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.h4,{id:"2-register-drm-manager-in-your-plugin-1",children:"2/ Register DRM manager in your plugin"}),"\n",(0,l.jsxs)(s.p,{children:["Implement ",(0,l.jsx)(s.code,{children:"getDRMManager()"})," in your AVPlayer plugin to provide the custom DRM manager:"]}),"\n",(0,l.jsx)(s.pre,{"data-language":"swift","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"swift","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CustomVideoPlugin"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"RNVAVPlayerPlugin "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getDRMManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" DRMManagerSpec"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"CustomDRMManager"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceCreated"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVPlayer) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player creation"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"override"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"func"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onInstanceRemoved"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"String"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"player"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:": AVPlayer) {"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Handle player removal"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.h3,{id:"important-notes-about-drm-managers",children:"Important notes about DRM managers:"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsx)(s.li,{children:"Only one plugin can provide a DRM manager at a time. If multiple plugins try to provide DRM managers, only the first one will be used."}),"\n",(0,l.jsx)(s.li,{children:"The custom DRM manager will be used for all video instances in the app."}),"\n",(0,l.jsxs)(s.li,{children:["If no custom DRM manager is provided:\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"On iOS, the default FairPlay-based implementation will be used"}),"\n",(0,l.jsx)(s.li,{children:"On Android, the default ExoPlayer DRM implementation will be used"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["The DRM manager must handle all DRM-related functionality:\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"On iOS: key requests, license acquisition, and error handling through AVContentKeySession"}),"\n",(0,l.jsx)(s.li,{children:"On Android: DRM session management and license acquisition through ExoPlayer's DrmSessionManager"}),"\n"]}),"\n"]}),"\n"]})]})}s.default=(0,r.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.a)(),e.components);return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(a,{...e})}):a(e)},pageOpts:{filePath:"pages/other/plugin.md",route:"/other/plugin",timestamp:1745514146e3,title:"Plugin",headings:o},pageNextRoute:"/other/plugin"})}},function(e){e.O(0,[673,888,774,179],function(){return e(e.s=9e3)}),_N_E=e.O()}]);