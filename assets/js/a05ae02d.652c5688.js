"use strict";(self.webpackChunk_react_native_video_docs=self.webpackChunk_react_native_video_docs||[]).push([["5788"],{6234:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>a,toc:()=>c,default:()=>h,metadata:()=>r,assets:()=>t,contentTitle:()=>o});var r=JSON.parse('{"id":"player/player-lifecycle","title":"Player Lifecycle","description":"Understanding the lifecycle of the VideoPlayer is crucial for managing resources effectively and ensuring a smooth user experience.","source":"@site/docs/player/player-lifecycle.md","sourceDirName":"player","slug":"/player/player-lifecycle","permalink":"/react-native-video/docs/v7/player/player-lifecycle","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_label":"Player Lifecycle","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Player","permalink":"/react-native-video/docs/v7/player/"},"next":{"title":"DRM","permalink":"/react-native-video/docs/v7/player/drm"}}'),l=i(4848),s=i(6151);let a={sidebar_label:"Player Lifecycle",sidebar_position:2},o="Player Lifecycle",t={},c=[{value:"Creation and Initialization",id:"creation-and-initialization",level:2},{value:"Deferred Initialization (Advanced)",id:"deferred-initialization-advanced",level:3},{value:"Initialization Methods Comparison",id:"initialization-methods-comparison",level:3},{value:"Playing a Video",id:"playing-a-video",level:2},{value:"Controlling Playback",id:"controlling-playback",level:2},{value:"Changing Source",id:"changing-source",level:2},{value:"Releasing Resources",id:"releasing-resources",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Using with Hooks (<code>useVideoPlayer</code>)",id:"using-with-hooks-usevideoplayer",level:2}];function d(e){let n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"player-lifecycle",children:"Player Lifecycle"})}),"\n",(0,l.jsxs)(n.p,{children:["Understanding the lifecycle of the ",(0,l.jsx)(n.code,{children:"VideoPlayer"})," is crucial for managing resources effectively and ensuring a smooth user experience."]}),"\n",(0,l.jsx)(n.h2,{id:"creation-and-initialization",children:"Creation and Initialization"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Instantiation"}),": A ",(0,l.jsx)(n.code,{children:"VideoPlayer"})," instance is created by calling its constructor with a video source (URL, ",(0,l.jsx)(n.code,{children:"VideoSource"}),", or ",(0,l.jsx)(n.code,{children:"VideoConfig"}),").","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"const player = new VideoPlayer('https://example.com/video.mp4');\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Native Player Allocation"}),": A lightweight native player object is allocated immediately."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Asset Initialization"}),": By default (unless you opt out) the underlying media item is prepared ",(0,l.jsx)(n.strong,{children:"asynchronously right after creation"}),". You can control this with ",(0,l.jsx)(n.code,{children:"initializeOnCreation"})," inside ",(0,l.jsx)(n.code,{children:"VideoConfig"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"deferred-initialization-advanced",children:"Deferred Initialization (Advanced)"}),"\n",(0,l.jsxs)(n.p,{children:["If you pass a ",(0,l.jsx)(n.code,{children:"VideoConfig"})," with ",(0,l.jsx)(n.code,{children:"{ initializeOnCreation: false }"}),", the player will skip preparing the media item automatically. This is useful when:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"You need to batch\u2011create many players without incurring immediate decoding / network cost"}),"\n",(0,l.jsx)(n.li,{children:"You want to attach event handlers before any network requests happen"}),"\n",(0,l.jsx)(n.li,{children:"You want explicit control over when buffering begins (e.g. on user interaction)"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"To initialize later, call:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"await player.initialize();\n// or preload if you also want it prepared & ready\nawait player.preload();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"initialization-methods-comparison",children:"Initialization Methods Comparison"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Method"}),(0,l.jsx)(n.th,{children:"When to use"}),(0,l.jsx)(n.th,{children:"What it does"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"initialize()"})}),(0,l.jsx)(n.td,{children:"You deferred initialization and now want to create the native player item / media source"}),(0,l.jsx)(n.td,{children:"Creates & attaches the underlying player item / media source without starting playback"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"preload()"})}),(0,l.jsxs)(n.td,{children:["You want the player item prepared (buffering kicked off) ahead of an upcoming ",(0,l.jsx)(n.code,{children:"play()"})," call"]}),(0,l.jsx)(n.td,{children:"Ensures the media source is set and prepared; resolves once preparation started (may already be initialized)"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Implicit (default)"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"initializeOnCreation"})," not set or ",(0,l.jsx)(n.code,{children:"true"})]}),(0,l.jsx)(n.td,{children:"Automatically schedules initialization after JS construction"})]})]})]}),"\n",(0,l.jsx)(n.admonition,{type:"info",children:(0,l.jsxs)(n.p,{children:["By default, the player initializes automatically after construction. If you need to defer initialization, set ",(0,l.jsx)(n.code,{children:"initializeOnCreation: false"})," in the config. You can then call ",(0,l.jsx)(n.code,{children:"player.initialize()"})," or ",(0,l.jsx)(n.code,{children:"player.preload()"})," later to start the player."]})}),"\n",(0,l.jsx)(n.h2,{id:"playing-a-video",children:"Playing a Video"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Loading"}),": When the player (auto) initializes, ",(0,l.jsx)(n.code,{children:"preload()"})," is called, or after ",(0,l.jsx)(n.code,{children:"replaceSourceAsync()"}),", the player starts loading the video metadata and buffering content.","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onLoadStart"}),": Fired when the video starts loading."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onLoad"}),": Fired when the video metadata is loaded and the player is ready to play (duration, dimensions, etc., are available)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onBuffer"}),": Fired when buffering starts or ends."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Playback"}),": Once enough data is buffered, playback begins.","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onPlaybackStateChange"}),": Fired when the playback state changes (e.g., from ",(0,l.jsx)(n.code,{children:"buffering"})," to ",(0,l.jsx)(n.code,{children:"playing"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onProgress"}),": Fired periodically with the current playback time."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onReadyToDisplay"}),": Fired when the first frame is ready to be displayed."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"controlling-playback",children:"Controlling Playback"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"pause()"}),": Pauses playback. ",(0,l.jsx)(n.code,{children:"status"})," changes to ",(0,l.jsx)(n.code,{children:"paused"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"seekTo(time)"}),", ",(0,l.jsx)(n.code,{children:"seekBy(time)"}),": Changes the current playback position. ",(0,l.jsx)(n.code,{children:"onSeek"})," is fired when the seek operation completes."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"set volume(value)"}),", ",(0,l.jsx)(n.code,{children:"set muted(value)"}),", ",(0,l.jsx)(n.code,{children:"set loop(value)"}),", ",(0,l.jsx)(n.code,{children:"set rate(value)"}),": Modify player properties. Corresponding events like ",(0,l.jsx)(n.code,{children:"onVolumeChange"})," or ",(0,l.jsx)(n.code,{children:"onPlaybackRateChange"})," might be fired."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"changing-source",children:"Changing Source"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"replaceSourceAsync(newSource)"}),": This method allows you to change the video source dynamically.","\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["The current native player resources associated with the old source are released (similar to ",(0,l.jsx)(n.code,{children:"release()"})," but specifically for the source)."]}),"\n",(0,l.jsxs)(n.li,{children:["A new native player instance (or reconfigured existing one) is prepared for the ",(0,l.jsx)(n.code,{children:"newSource"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["The loading lifecycle events (",(0,l.jsx)(n.code,{children:"onLoadStart"}),", ",(0,l.jsx)(n.code,{children:"onLoad"}),", etc.) will fire for the new source."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"replaceSourceAsync(null)"}),": This effectively unloads the current video and releases its associated resources without loading a new one. This is useful for freeing up memory if the player is temporarily not needed but might be used again later."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"releasing-resources",children:"Releasing Resources"}),"\n",(0,l.jsx)(n.p,{children:"There are two main ways to release resources:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"replaceSourceAsync(null)"})}),": This is a less destructive way to free resources related ",(0,l.jsx)(n.em,{children:"only"})," to the current video source."]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["The ",(0,l.jsx)(n.code,{children:"VideoPlayer"})," instance itself remains usable."]}),"\n",(0,l.jsxs)(n.li,{children:["You can later call ",(0,l.jsx)(n.code,{children:"replaceSourceAsync(newSource)"})," to load and play a new video."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"release()"})}),": This is a destructive operation."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"danger",children:(0,l.jsxs)(n.p,{children:["After calling ",(0,l.jsx)(n.code,{children:"release()"}),", the player instance becomes unusable. Any subsequent calls to its methods or property access will result in errors."]})}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.p,{children:["It is recommended to use ",(0,l.jsx)(n.code,{children:"replaceSourceAsync(null)"})," when you want to free resources related to the current video source. You should call ",(0,l.jsx)(n.code,{children:"release()"})," only when you are 100% sure that you don't need the player instance anymore. Anyway garbage collector will release the player instance when it is no longer needed."]})}),"\n",(0,l.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["The ",(0,l.jsx)(n.code,{children:"onError"})," callback, if provided, will be called when a ",(0,l.jsx)(n.code,{children:"VideoRuntimeError"})," occurs. This allows you to handle issues like network errors, invalid source, or platform-specific playback problems."]}),"\n",(0,l.jsxs)(n.li,{children:["If ",(0,l.jsx)(n.code,{children:"onError"})," is not provided, errors might be thrown as exceptions."]}),"\n"]}),"\n",(0,l.jsxs)(n.h2,{id:"using-with-hooks-usevideoplayer",children:["Using with Hooks (",(0,l.jsx)(n.code,{children:"useVideoPlayer"}),")"]}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"useVideoPlayer"})," hook simplifies managing the ",(0,l.jsx)(n.code,{children:"VideoPlayer"})," lifecycle within React components."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"import { useVideoPlayer } from 'react-native-video';\n\nconst MyComponent = () => {\n  const player = useVideoPlayer('https://example.com/video.mp4', (playerInstance) => {\n    // Optional setup function: configure the player instance after creation\n    playerInstance.loop = true;\n  });\n\n  // ... use player ...\n\n  return <VideoView player={player} />;\n};\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Automatic Creation"}),": ",(0,l.jsx)(n.code,{children:"useVideoPlayer"})," creates a ",(0,l.jsx)(n.code,{children:"VideoPlayer"})," instance when the component mounts or when the source dependency changes."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Automatic Cleanup"}),": It automatically cleanup resources when the component unmounts or before recreating the player due to a source change. This prevents resource leaks."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Dependency Management"}),": If the ",(0,l.jsx)(n.code,{children:"source"})," prop passed to ",(0,l.jsx)(n.code,{children:"useVideoPlayer"})," changes, the hook will clean up the old player instance and create a new one with the new source."]}),"\n"]}),"\n",(0,l.jsxs)(n.admonition,{type:"tip",children:[(0,l.jsxs)(n.p,{children:["Using ",(0,l.jsx)(n.code,{children:"useVideoPlayer"})," is the recommended way to manage ",(0,l.jsx)(n.code,{children:"VideoPlayer"})," instances in functional components to ensure proper lifecycle management and resource cleanup. It will also respect ",(0,l.jsx)(n.code,{children:"initializeOnCreation"})," (defaults to ",(0,l.jsx)(n.code,{children:"true"}),"). If you need deferred initialization with the hook:"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"const player = useVideoPlayer({\n    source: { uri: 'https://example.com/video.mp4' },\n    initializeOnCreation: false,\n}, (instance) => {\n    // Attach listeners first\n    instance.onLoad = () => console.log('Loaded');\n});\n\n// Later (e.g. on user tap)\nawait player.initialize(); // or player.preload()\nplayer.play();\n"})})]})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},6151:function(e,n,i){i.d(n,{R:()=>a,x:()=>o});var r=i(6540);let l={},s=r.createContext(l);function a(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);