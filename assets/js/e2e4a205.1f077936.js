"use strict";(self.webpackChunk_react_native_video_docs=self.webpackChunk_react_native_video_docs||[]).push([["4238"],{637:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>d,toc:()=>o,default:()=>h,metadata:()=>t,assets:()=>c,contentTitle:()=>l});var t=JSON.parse('{"id":"player/drm","title":"DRM","description":"What is DRM (Digital Rights Management)?","source":"@site/docs/player/drm.md","sourceDirName":"player","slug":"/player/drm","permalink":"/react-native-video/docs/v7/player/drm","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"sidebar_label":"DRM"},"sidebar":"docsSidebar","previous":{"title":"VideoPlayer","permalink":"/react-native-video/docs/v7/player/video-player"},"next":{"title":"Events","permalink":"/react-native-video/docs/v7/player/events"}}'),r=i(4848),s=i(6151);let d={sidebar_position:4,sidebar_label:"DRM"},l="DRM",c={},o=[{value:"What is DRM (Digital Rights Management)?",id:"what-is-drm-digital-rights-management",level:2},{value:"When do you need it?",id:"when-do-you-need-it",level:3},{value:"What next?",id:"what-next",level:3},{value:"Install and enable the DRM plugin",id:"install-and-enable-the-drm-plugin",level:2},{value:"Quick start",id:"quick-start",level:2},{value:"DRM config reference",id:"drm-config-reference",level:2},{value:"Android: Widevine",id:"android-widevine",level:2},{value:"iOS and visionOS: FairPlay",id:"ios-and-visionos-fairplay",level:2},{value:"Offline",id:"offline",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Notes and defaults",id:"notes-and-defaults",level:2}];function a(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"drm",children:"DRM"})}),"\n",(0,r.jsx)(n.h2,{id:"what-is-drm-digital-rights-management",children:"What is DRM (Digital Rights Management)?"}),"\n",(0,r.jsx)(n.p,{children:"DRM is a set of access control technologies that are used to protect copyrighted content from unauthorized use and distribution. It allows content owners to control how their digital media is used and distributed."}),"\n",(0,r.jsx)(n.h3,{id:"when-do-you-need-it",children:"When do you need it?"}),"\n",(0,r.jsx)(n.p,{children:"If you are working with copyrighted content and want to prevent unauthorized access or distribution, you will need DRM. It is especially important for streaming services, e-learning platforms, and any application that delivers premium content that you want to protect from piracy."}),"\n",(0,r.jsx)(n.h3,{id:"what-next",children:"What next?"}),"\n",(0,r.jsx)(n.p,{children:"This page explains how to play DRM\u2011protected content with React Native Video using the official DRM plugin. It covers installing and enabling the plugin, configuring sources with DRM, and platform\u2011specific notes for Android (Widevine) and iOS/visionOS (FairPlay)."}),"\n",(0,r.jsx)(n.h2,{id:"install-and-enable-the-drm-plugin",children:"Install and enable the DRM plugin"}),"\n",(0,r.jsx)(n.admonition,{title:"Pluginable Architecture",type:"tip",children:(0,r.jsxs)(n.p,{children:["React Native Video uses a plugin architecture. DRM support is provided by the ",(0,r.jsx)(n.code,{children:"@react-native-video/drm"})," plugin and is not built into the core package."]})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Install dependencies in your app:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"npm install @react-native-video/drm\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Enable the plugin at app startup (before creating any players):"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// App.tsx (or any place you want to initialize the plugin)\nimport { enable } from '@react-native-video/drm';\n\nenable();\n"})}),"\n",(0,r.jsx)(n.p,{children:"The plugin autolinks on both Android and iOS. Nitro Modules are required because the plugin uses Nitro under the hood."}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick start"}),"\n",(0,r.jsxs)(n.p,{children:["You pass DRM configuration via ",(0,r.jsx)(n.code,{children:"VideoConfig.drm"})," when creating a player or using the ",(0,r.jsx)(n.code,{children:"useVideoPlayer"})," hook. If ",(0,r.jsx)(n.code,{children:"drm.type"})," is omitted, the default is inferred per platform (",(0,r.jsx)(n.code,{children:"widevine"})," on Android, ",(0,r.jsx)(n.code,{children:"fairplay"})," on iOS/visionOS)."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { VideoView, useVideoPlayer } from 'react-native-video';\n\nexport function Player() {\n  const player = useVideoPlayer({\n    source: {\n    uri: 'https://example.com/manifest.mpd', // or HLS .m3u8 for FairPlay\n    // On iOS these headers are also used for the default license request\n    headers: { Authorization: 'Bearer <token>' },\n    drm: {\n      // type: 'widevine' | 'fairplay'  // optional; inferred by platform\n      licenseUrl: 'https://license.example.com/widevine',\n    },\n  },\n  });\n\n  return <VideoView player={player} />;\n}\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"You shouldn't include your authorization token directly in the code. Instead, use a backend method to retrieve it at runtime."})}),"\n",(0,r.jsx)(n.h2,{id:"drm-config-reference",children:"DRM config reference"}),"\n",(0,r.jsx)(n.p,{children:"All properties are optional unless marked otherwise for a platform. The table below describes each property, the expected type, platforms where it applies, whether it's required, and important notes."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{style:{textAlign:"right"},children:"Type"}),(0,r.jsx)(n.th,{children:"Platform"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Required"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"type"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"'widevine' | 'fairplay'"})}),(0,r.jsx)(n.td,{children:"Android, iOS, visionOS"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No (defaulted)"}),(0,r.jsxs)(n.td,{children:["Default inferred per platform when ",(0,r.jsx)(n.code,{children:"drm"})," is present and ",(0,r.jsx)(n.code,{children:"type"})," omitted (Android \u2192 ",(0,r.jsx)(n.code,{children:"widevine"}),", iOS/visionOS \u2192 ",(0,r.jsx)(n.code,{children:"fairplay"}),")."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"licenseUrl"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"Android, iOS, visionOS"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"Android: Yes; iOS/visionOS: Yes for default/custom flows"}),(0,r.jsx)(n.td,{children:"URL of the license (CKC) service. Required for license acquisition."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"licenseHeaders"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"Record<string, string>"})}),(0,r.jsx)(n.td,{children:"Android"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsxs)(n.td,{children:["Extra headers sent with the Widevine license request. (On iOS, use ",(0,r.jsx)(n.code,{children:"source.headers"})," for license requests.)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"multiSession"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:"Android"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Whether to allow multiple Widevine sessions."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"certificateUrl"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"iOS, visionOS"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"Yes (for FairPlay)"}),(0,r.jsx)(n.td,{children:"URL to fetch the FairPlay application certificate (used to create the SPC)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"contentId"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"iOS, visionOS"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsxs)(n.td,{children:["If omitted, derived from the ",(0,r.jsx)(n.code,{children:"skd://"})," key URL. Used when creating the SPC."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"getLicense"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"(payload) => Promise<string>"})}),(0,r.jsx)(n.td,{children:"iOS, visionOS"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"No"}),(0,r.jsx)(n.td,{children:"Optional hook for custom FairPlay license logic; must resolve to a base64\u2011encoded CKC string."})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Payload shape passed to ",(0,r.jsx)(n.code,{children:"getLicense"})," (iOS/visionOS):"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{style:{textAlign:"right"},children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"contentId"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsxs)(n.td,{children:["Content identifier for the asset. If not provided the player will try to derive it from the ",(0,r.jsx)(n.code,{children:"skd://"})," key URL."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"licenseUrl"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"The license server URL that should be used for license acquisition."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"keyUrl"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsxs)(n.td,{children:["The key URL/identifier received from the stream (typically an ",(0,r.jsx)(n.code,{children:"skd://"})," URL)."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"spc"})}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"The SPC (secure playback context) as a base64\u2011encoded string. Send raw SPC bytes to your license server (server side may expect raw bytes rather than base64)."})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"android-widevine",children:"Android: Widevine"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.code,{children:"drm.type"})," to ",(0,r.jsx)(n.code,{children:"'widevine'"})," or omit it (the library will default to Widevine on Android if ",(0,r.jsx)(n.code,{children:"drm"})," is present)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"licenseUrl"})," is required; ",(0,r.jsx)(n.code,{children:"licenseHeaders"})," and ",(0,r.jsx)(n.code,{children:"multiSession"})," are optional."]}),"\n",(0,r.jsxs)(n.li,{children:["Implementation details:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The plugin uses ExoPlayer\u2019s ",(0,r.jsx)(n.code,{children:"DefaultDrmSessionManager"})," and ",(0,r.jsx)(n.code,{children:"HttpMediaDrmCallback"})," with your ",(0,r.jsx)(n.code,{children:"licenseUrl"})," and ",(0,r.jsx)(n.code,{children:"licenseHeaders"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["If a first attempt fails due to device security level issues, the plugin retries with ",(0,r.jsx)(n.code,{children:"L3"})," security level."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"useVideoPlayer({\n  source: {\n    uri: 'https://example.com/manifest.mpd',\n    drm: {\n      // type: 'widevine', // optional\n      licenseUrl: 'https://license.example.com/widevine',\n      licenseHeaders: { 'X-Custom-Header': 'value' },\n      multiSession: false,\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"ios-and-visionos-fairplay",children:"iOS and visionOS: FairPlay"}),"\n",(0,r.jsx)(n.p,{children:"Two ways to get the CKC (license):"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Default flow (no ",(0,r.jsx)(n.code,{children:"getLicense"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Required: ",(0,r.jsx)(n.code,{children:"certificateUrl"}),", ",(0,r.jsx)(n.code,{children:"licenseUrl"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The plugin requests the application certificate, generates the SPC, then POSTs the SPC to ",(0,r.jsx)(n.code,{children:"licenseUrl"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["It uses ",(0,r.jsx)(n.code,{children:"source.headers"})," (not ",(0,r.jsx)(n.code,{children:"drm.licenseHeaders"}),") for the license request."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Custom flow (provide ",(0,r.jsx)(n.code,{children:"getLicense"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Required: ",(0,r.jsx)(n.code,{children:"certificateUrl"}),", ",(0,r.jsx)(n.code,{children:"licenseUrl"}),", and a ",(0,r.jsx)(n.code,{children:"getLicense"})," implementation."]}),"\n",(0,r.jsxs)(n.li,{children:["You receive ",(0,r.jsx)(n.code,{children:"{ contentId, licenseUrl, keyUrl, spc }"})," and must return a base64\u2011encoded CKC string."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["DRM isn\u2019t supported in the iOS Simulator; the plugin returns ",(0,r.jsx)(n.code,{children:"null"})," for DRM in Simulator builds."]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"contentId"})," isn\u2019t provided, it is derived from the ",(0,r.jsx)(n.code,{children:"skd://"})," key URL."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Default flow example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"useVideoPlayer({\n  source: {\n    uri: 'https://example.com/fairplay.m3u8',\n    headers: { Authorization: 'Bearer <token>' }, // used for the license request\n    drm: {\n      // type: 'fairplay', // optional\n      certificateUrl: 'https://license.example.com/fps-cert',\n      licenseUrl: 'https://license.example.com/fps',\n      // contentId: 'my-content-id', // optional\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Custom ",(0,r.jsx)(n.code,{children:"getLicense"})," example:"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["This is example code for a custom ",(0,r.jsx)(n.code,{children:"getLicense"})," implementation. it may differ from your actual implementation provided by your DRM provider"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"useVideoPlayer({\n  source: {\n  uri: 'https://example.com/fairplay.m3u8',\n  drm: {\n    certificateUrl: 'https://license.example.com/fps-cert',\n    licenseUrl: 'https://license.example.com/fps',\n    getLicense: async ({ contentId, licenseUrl, keyUrl, spc }) => {\n      // Example: POST SPC to your license server and return base64 CKC\n        const res = await fetch(licenseUrl, {\n          method: 'POST',\n          body: Buffer.from(spc, 'base64'), // server expects raw SPC bytes\n          headers: {\n            'Content-Type': 'application/octet-stream',\n            'X-Content-ID': contentId,\n            'X-Asset-Id': keyUrl,\n          },\n        });\n        if (!res.ok) throw new Error(`License request failed: ${res.status}`);\n        const ckc = await res.arrayBuffer();\n        // return base64 CKC string\n        return Buffer.from(ckc).toString('base64');\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"offline",children:"Offline"}),"\n",(0,r.jsxs)(n.p,{children:["If you are looking for implementing offline playback with DRM, make sure to checkout our ",(0,r.jsx)(n.a,{href:"https://www.thewidlarzgroup.com/offline-video-sdk?utm_source=rnv&utm_medium=docs&utm_campaign=drm&utm_id=offline-sdk-link",children:"Offline Video SDK"}),". It provides a comprehensive solution for downloading and playing Streams and DRM-protected content."]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["DRMPluginNotFound: Ensure you installed ",(0,r.jsx)(n.code,{children:"@react-native-video/drm"}),", imported it, and called ",(0,r.jsx)(n.code,{children:"enable()"})," before creating any players."]}),"\n",(0,r.jsxs)(n.li,{children:["iOS headers: The default FairPlay flow uses ",(0,r.jsx)(n.code,{children:"source.headers"})," for license requests; ",(0,r.jsx)(n.code,{children:"drm.licenseHeaders"})," are not used on iOS."]}),"\n",(0,r.jsxs)(n.li,{children:["Invalid CKC: ",(0,r.jsx)(n.code,{children:"getLicense"})," must return a base64 string. Returning raw bytes or JSON will fail."]}),"\n",(0,r.jsx)(n.li,{children:"403/415 from license server: Verify required auth headers, content type, and whether the server expects raw SPC bytes vs base64."}),"\n",(0,r.jsx)(n.li,{children:"Android security level issues: The plugin retries with Widevine L3 if the first attempt fails."}),"\n",(0,r.jsx)(n.li,{children:"iOS Simulator: DRM isn\u2019t supported in Simulator. Test on a real device."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"notes-and-defaults",children:"Notes and defaults"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"drm"})," is provided without ",(0,r.jsx)(n.code,{children:"type"}),", the library sets a platform default: Android \u2192 Widevine, iOS/visionOS \u2192 FairPlay."]}),"\n",(0,r.jsx)(n.li,{children:"For custom DRM systems or advanced pipelines, you can implement your own plugin. See the Plugin Interface docs."}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},6151:function(e,n,i){i.d(n,{R:()=>d,x:()=>l});var t=i(6540);let r={},s=t.createContext(r);function d(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);